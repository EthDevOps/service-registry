@model QuokkaServiceRegistry.Models.VendorBillingViewModel

<!-- Payment Information -->
<div class="card mb-4">
    <div class="card-header">
        <h5 class="card-title mb-0">
            <i class="fas fa-credit-card"></i> Payment Information
        </h5>
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-8">
                <div class="form-group mb-3">
                    <label asp-for="PaymentMethodId" class="form-label">Payment Method</label>
                    <select asp-for="PaymentMethodId" class="form-select" asp-items="ViewBag.PaymentMethodId" id="paymentMethodSelect">
                        <option value="">-- No Payment Method (Free Service) --</option>
                    </select>
                    <span asp-validation-for="PaymentMethodId" class="text-danger"></span>
                    <div class="form-text">
                        Select a centralized payment method or leave empty for free services.
                        <a asp-controller="Payment" asp-action="Create" target="_blank">
                            <i class="fas fa-plus"></i> Create New Payment Method
                        </a>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="form-group mb-3">
                    <div class="form-check mt-4">
                        <input asp-for="IsActive" class="form-check-input" />
                        <label asp-for="IsActive" class="form-check-label">
                            Is Active
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <!-- Payment Method Preview -->
        <div id="paymentMethodPreview" class="alert alert-info d-none">
            <h6><i class="fas fa-info-circle"></i> Selected Payment Method Details</h6>
            <div id="paymentMethodDetails"></div>
        </div>
    </div>
</div>

<script>
function showPaymentMethodPreview() {
    var selectElement = document.getElementById('paymentMethodSelect');
    var selectedOption = selectElement.options[selectElement.selectedIndex];
    var previewDiv = document.getElementById('paymentMethodPreview');
    var detailsDiv = document.getElementById('paymentMethodDetails');
    
    if (selectedOption.value === '') {
        previewDiv.classList.add('d-none');
        return;
    }
    
    // Get payment method details from option data attributes
    var paymentType = selectedOption.getAttribute('data-type');
    var costCenter = selectedOption.getAttribute('data-cost-center');
    var description = selectedOption.getAttribute('data-description');
    
    var html = '<div class="row">';
    
    if (paymentType) {
        var typeIcon = '';
        var typeBadgeClass = 'bg-secondary';
        
        switch(paymentType) {
            case 'CreditCard':
                typeIcon = '<i class="fas fa-credit-card text-primary me-1"></i>';
                typeBadgeClass = 'bg-primary';
                break;
            case 'BankTransfer':
                typeIcon = '<i class="fas fa-university text-success me-1"></i>';
                typeBadgeClass = 'bg-success';
                break;
            case 'SEPA':
                typeIcon = '<i class="fas fa-euro-sign text-info me-1"></i>';
                typeBadgeClass = 'bg-info';
                break;
            case 'Prepaid':
                typeIcon = '<i class="fas fa-gift-card text-warning me-1"></i>';
                typeBadgeClass = 'bg-warning';
                break;
        }
        
        html += '<div class="col-md-4"><strong>Type:</strong><br>' + typeIcon + '<span class="badge ' + typeBadgeClass + '">' + paymentType + '</span></div>';
    }
    
    if (costCenter) {
        html += '<div class="col-md-4"><strong>Cost Center:</strong><br>' + costCenter + '</div>';
    }
    
    if (description) {
        html += '<div class="col-md-4"><strong>Description:</strong><br>' + description + '</div>';
    }
    
    html += '</div>';
    
    detailsDiv.innerHTML = html;
    previewDiv.classList.remove('d-none');
}

// Initialize on page load
document.addEventListener('DOMContentLoaded', function() {
    var selectElement = document.getElementById('paymentMethodSelect');
    if (selectElement) {
        selectElement.addEventListener('change', showPaymentMethodPreview);
        showPaymentMethodPreview(); // Show preview if there's a selected value on load
    }
});
</script>